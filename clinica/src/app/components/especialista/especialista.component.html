<form [formGroup]="especialistaForm" (ngSubmit)="onSubmit()" novalidate class="especialista-form">

  <!-- Datos personales -->
  <div class="form-section">
    <h3 class="section-title">ğŸ‘¨â€âš•ï¸ Datos Personales</h3>
    
    <div class="form-row">
      <div class="form-group">
        <label for="nombre">ğŸ“ Nombre</label>
        <input id="nombre" type="text" placeholder="Ingresa tu nombre" formControlName="nombre" />
        <div class="error-message" *ngIf="f.nombre.touched && f.nombre.errors?.['required']">
          âš ï¸ El nombre es obligatorio
        </div>
        <div class="error-message" *ngIf="f.nombre.touched && f.nombre.errors?.['pattern']">
          âš ï¸ Solo letras y espacios permitidos
        </div>
      </div>

      <div class="form-group">
        <label for="apellido">ğŸ“ Apellido</label>
        <input id="apellido" type="text" placeholder="Ingresa tu apellido" formControlName="apellido" />
        <div class="error-message" *ngIf="f.apellido.touched && f.apellido.errors?.['required']">
          âš ï¸ El apellido es obligatorio
        </div>
        <div class="error-message" *ngIf="f.apellido.touched && f.apellido.errors?.['pattern']">
          âš ï¸ Solo letras y espacios permitidos
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="edad">ğŸ‚ Edad</label>
        <input id="edad" type="number" placeholder="Tu edad" formControlName="edad" min="18" max="120" />
        <div class="error-message" *ngIf="f.edad.touched && f.edad.errors?.['required']">
          âš ï¸ La edad es obligatoria
        </div>
        <div class="error-message" *ngIf="f.edad.touched && f.edad.errors?.['min']">
          âš ï¸ Debe ser mayor de 18 aÃ±os
        </div>
        <div class="error-message" *ngIf="f.edad.touched && f.edad.errors?.['max']">
          âš ï¸ Edad mÃ¡xima 120 aÃ±os
        </div>
      </div>

      <div class="form-group">
        <label for="dni">ğŸ†” DNI</label>
        <input id="dni" type="number" placeholder="Tu DNI (8 dÃ­gitos)" formControlName="dni" maxlength="8" />
        <div class="error-message" *ngIf="f.dni.touched && f.dni.errors?.['required']">
          âš ï¸ El DNI es obligatorio
        </div>
        <div class="error-message" *ngIf="f.dni.touched && f.dni.errors?.['pattern']">
          âš ï¸ Debe tener exactamente 8 nÃºmeros
        </div>
      </div>
    </div>
  </div>

  <!-- Especialidad mÃ©dica -->
  <div class="form-section">
    <h3 class="section-title">ğŸ©º Especialidad MÃ©dica</h3>
    
    <div class="form-group">
      <label for="especialidad">ğŸ¥ Especialidad</label>
      <select id="especialidad" formControlName="especialidad" (change)="onEspecialidadChange($event)">
        <option value="" disabled>-- Elegir especialidad --</option>
        <option *ngFor="let e of especialidadesDisponibles" [value]="e">{{ e }}</option>
        <option value="agregar">â• Agregar nueva especialidad...</option>
      </select>
      <div class="error-message" *ngIf="f.especialidad.touched && f.especialidad.errors?.['required']">
        âš ï¸ La especialidad es obligatoria
      </div>

      <!-- Input para nueva especialidad -->
      <div class="nueva-especialidad" *ngIf="agregarNuevaEspecialidad">
        <label for="nuevaEspecialidad">âœï¸ Nueva Especialidad</label>
        <input id="nuevaEspecialidad" 
               type="text"
               placeholder="EscribÃ­ tu especialidad"
               [(ngModel)]="nuevaEspecialidad"
               (ngModelChange)="f.especialidad.setValue(nuevaEspecialidad)"
               name="nuevaEspecialidad"
               required />
        <div class="error-message" *ngIf="agregarNuevaEspecialidad && !nuevaEspecialidad.trim()">
          âš ï¸ La nueva especialidad es obligatoria
        </div>
      </div>
    </div>
  </div>

  <!-- Datos de acceso -->
  <div class="form-section">
    <h3 class="section-title">ğŸ” Datos de Acceso</h3>
    
    <div class="form-group">
      <label for="email">ğŸ“§ Email</label>
      <input id="email" type="email" placeholder="tu-email@ejemplo.com" formControlName="email" />
      <div class="error-message" *ngIf="f.email.touched && f.email.errors?.['required']">
        âš ï¸ El email es obligatorio
      </div>
      <div class="error-message" *ngIf="f.email.touched && f.email.errors?.['email']">
        âš ï¸ Formato de email invÃ¡lido
      </div>
    </div>

    <div class="form-group">
      <label for="password">ğŸ”‘ ContraseÃ±a</label>
      <input id="password" type="password" placeholder="6-10 caracteres, mayÃºscula y nÃºmero" formControlName="password" />
      <div class="error-message" *ngIf="f.password.touched && f.password.errors?.['required']">
        âš ï¸ La contraseÃ±a es obligatoria
      </div>
      <div class="error-message" *ngIf="f.password.touched && f.password.errors?.['minlength']">
        âš ï¸ MÃ­nimo 6 caracteres
      </div>
      <div class="error-message" *ngIf="f.password.touched && f.password.errors?.['maxlength']">
        âš ï¸ MÃ¡ximo 10 caracteres
      </div>
      <div class="error-message" *ngIf="f.password.touched && f.password.errors?.['pattern']">
        âš ï¸ Debe incluir una mayÃºscula y un nÃºmero
      </div>
    </div>
  </div>

  <!-- Imagen de perfil -->
  <div class="form-section">
    <h3 class="section-title">ğŸ“¸ Imagen de Perfil</h3>
    
    <div class="form-group">
      <label for="imagenPerfil">ğŸ–¼ï¸ Foto de Perfil</label>
      <div class="file-input-container">
        <input id="imagenPerfil" type="file" (change)="subirImagen($event)" accept="image/*" />
        <div class="file-preview" *ngIf="imagenPreview">
          <img [src]="imagenPreview" alt="Vista previa" class="preview-img">
        </div>
      </div>
      <div class="error-message" *ngIf="f.imagenPerfil.touched && f.imagenPerfil.errors?.['required']">
        âš ï¸ La imagen de perfil es obligatoria
      </div>
    </div>
  </div>

  <!-- BotÃ³n de crear (oculto, se maneja desde el padre) -->
  <div class="form-actions" style="display: none;">
    <button type="button" (click)="onSubmit()" [disabled]="loading || especialistaForm.invalid">
      <span *ngIf="loading">â³ Creando...</span>
      <span *ngIf="!loading">âœ… Crear Especialista</span>
    </button>
  </div>

</form>
